steps:
- task: UsePythonVersion@0
  inputs:
    versionSpec: ${{ parameters.pythonVersion }}
    addToPath: true
    architecture: x64
- script: |
    git clone https://github.com/electrumsv/electrumsv-sdk.git
    cd electrumsv-sdk
    python3 -m pip install -e .
    cd ..

    python3 -m pip install pytest pytest-cov pytest-asyncio pytest-timeout electrumsv_node
    python3 -m pytest -v -v -v contrib/functional_tests/functional
  displayName: 'Functional tests (via SDK & REST API)'

- task: PublishBuildArtifacts@1
  inputs:
    pathToPublish: $(NEW_LOG_DIR)
    artifactName: $(Agent.OS)_functional_testing_server_logs
  displayName: 'Publish logs'
